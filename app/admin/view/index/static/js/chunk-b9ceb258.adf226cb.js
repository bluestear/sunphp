(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b9ceb258"],{"28a5":function(e,s,t){"use strict";var i=t("aae3"),a=t("cb7c"),l=t("ebd6"),n=t("0390"),r=t("9def"),o=t("5f1b"),c=t("520a"),p=t("79e5"),u=Math.min,m=[].push,v="split",d="length",f="lastIndex",h=4294967295,y=!p((function(){RegExp(h,"y")}));t("214f")("split",2,(function(e,s,t,p){var g;return g="c"=="abbc"[v](/(b)*/)[1]||4!="test"[v](/(?:)/,-1)[d]||2!="ab"[v](/(?:ab)*/)[d]||4!="."[v](/(.?)(.?)/)[d]||"."[v](/()()/)[d]>1||""[v](/.?/)[d]?function(e,s){var a=String(this);if(void 0===e&&0===s)return[];if(!i(e))return t.call(a,e,s);var l,n,r,o=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),u=0,v=void 0===s?h:s>>>0,y=new RegExp(e.source,p+"g");while(l=c.call(y,a)){if(n=y[f],n>u&&(o.push(a.slice(u,l.index)),l[d]>1&&l.index<a[d]&&m.apply(o,l.slice(1)),r=l[0][d],u=n,o[d]>=v))break;y[f]===l.index&&y[f]++}return u===a[d]?!r&&y.test("")||o.push(""):o.push(a.slice(u)),o[d]>v?o.slice(0,v):o}:"0"[v](void 0,0)[d]?function(e,s){return void 0===e&&0===s?[]:t.call(this,e,s)}:t,[function(t,i){var a=e(this),l=void 0==t?void 0:t[s];return void 0!==l?l.call(t,a,i):g.call(String(a),t,i)},function(e,s){var i=p(g,e,this,s,g!==t);if(i.done)return i.value;var c=a(e),m=String(this),v=l(c,RegExp),d=c.unicode,f=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(y?"y":"g"),_=new v(y?c:"^(?:"+c.source+")",f),b=void 0===s?h:s>>>0;if(0===b)return[];if(0===m.length)return null===o(_,m)?[m]:[];var w=0,q=0,k=[];while(q<m.length){_.lastIndex=y?q:0;var x,$=o(_,y?m:m.slice(q));if(null===$||(x=u(r(_.lastIndex+(y?0:q)),m.length))===w)q=n(m,q,d);else{if(k.push(m.slice(w,q)),k.length===b)return k;for(var C=1;C<=$.length-1;C++)if(k.push($[C]),k.length===b)return k;q=w=x}}return k.push(m.slice(w)),k}]}))},"4ffd":function(e,s,t){e.exports=t.p+"static/img/logo.ec0a7dab.png"},"5b18":function(e,s,t){"use strict";t("6f9f")},"6f9f":function(e,s,t){},"7f98":function(e,s,t){"use strict";t.r(s);var i=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{class:{"div-install":!e.is_lock}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.is_lock,expression:"!is_lock"}],staticClass:"install-container"},[e._m(0),e._v(" "),t("div",{staticClass:"div-steps"},[t("el-steps",{staticStyle:{width:"800px"},attrs:{active:e.step,"finish-status":"finish",simple:""}},[t("el-step",{attrs:{title:"检查安装环境",icon:"el-icon-check"}}),e._v(" "),t("el-step",{attrs:{title:"设置运行参数",icon:"el-icon-edit"}}),e._v(" "),t("el-step",{attrs:{title:"安装",icon:"el-icon-menu"}})],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:0==e.step,expression:"step==0"}],staticClass:"login-form"},[t("div",{staticClass:"div-check"},[t("span",[e._v("php版本")]),e._v(" "),t("span",[e._v(e._s(e.system.php)+"\n          "),t("span",{staticStyle:{color:"red","margin-left":"20px"}},[e._v("(推荐版本php7.4)")])])]),e._v(" "),t("div",{staticClass:"div-check"},[t("span",[e._v("服务器系统")]),e._v(" "),t("span",[e._v(e._s(e.system.linux))])]),e._v(" "),t("div",{staticClass:"div-check"},[t("span",[e._v("服务器软件")]),e._v(" "),t("span",[e._v(e._s(e.system.server))])]),e._v(" "),t("div",{staticClass:"div-check"},[t("span",[e._v("sql文件")]),e._v(" "),e.system.sql?t("span",[e._v(e._s(e.system.sql))]):t("span",{staticStyle:{color:"red"}},[e._v("数据库sql文件不存在")])]),e._v(" "),t("div",{staticClass:"div-check"},[t("span",[e._v("sunphp版本")]),e._v(" "),t("span",[e._v(e._s(e.system.version))])])]),e._v(" "),t("el-form",{directives:[{name:"show",rawName:"v-show",value:1==e.step,expression:"step==1"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"infoForm",staticClass:"login-form",attrs:{model:e.mysql,"label-position":"left","label-width":"120px"}},[t("el-form-item",{attrs:{label:"数据库地址",prop:"hostname",rules:e.rules.notEmpty}},[t("el-input",{attrs:{placeholder:"本机地址127.0.0.1"},model:{value:e.mysql.hostname,callback:function(s){e.$set(e.mysql,"hostname",s)},expression:"mysql.hostname"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"数据库名称",prop:"database",rules:e.rules.notEmpty}},[t("el-input",{model:{value:e.mysql.database,callback:function(s){e.$set(e.mysql,"database",s)},expression:"mysql.database"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"数据库用户",prop:"username",rules:e.rules.notEmpty}},[t("el-input",{model:{value:e.mysql.username,callback:function(s){e.$set(e.mysql,"username",s)},expression:"mysql.username"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"数据库密码",prop:"password",rules:e.rules.notEmpty}},[t("el-input",{model:{value:e.mysql.password,callback:function(s){e.$set(e.mysql,"password",s)},expression:"mysql.password"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"管理员账号",prop:"name",rules:e.rules.notEmpty}},[t("el-input",{model:{value:e.mysql.name,callback:function(s){e.$set(e.mysql,"name",s)},expression:"mysql.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"管理员密码",prop:"pwd",rules:e.rules.notEmpty}},[t("el-input",{model:{value:e.mysql.pwd,callback:function(s){e.$set(e.mysql,"pwd",s)},expression:"mysql.pwd"}})],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:2==e.step,expression:"step==2"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"login-form installing"},[t("div",{staticClass:"install-info"},[t("el-alert",{attrs:{title:"安装过程中，请勿关闭此页面！",type:"error",closable:!1,center:""}})],1),e._v(" "),t("el-button",{attrs:{type:"primary",plain:"",size:"middle"},on:{click:e.tapInstall}},[e._v("立即安装")])],1),e._v(" "),t("div",{staticClass:"login-form bt-group"},[t("el-button",{attrs:{disabled:0==e.step,size:"small",icon:"el-icon-arrow-left"},on:{click:e.tapBefore}},[e._v("上一步")]),e._v(" "),t("el-button",{attrs:{disabled:2==e.step,size:"small"},on:{click:e.tapNext}},[e._v("下一步"),t("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)],1)])},a=[function(){var e=this,s=e.$createElement,i=e._self._c||s;return i("div",{staticClass:"title-container"},[i("img",{staticClass:"avatar",attrs:{src:t("4ffd")}}),e._v(" "),i("span",{staticClass:"title"},[e._v("sunphp")])])}],l=(t("28a5"),t("a481"),{name:"Install",components:{},data:function(){return{step:0,system:{},is_lock:!0,loading:!1,mysql:{hostname:"127.0.0.1",database:"",username:"",password:"",name:"admin",pwd:"123456"},rules:{notEmpty:[{required:!0,trigger:"blur",message:"不能为空"}]}}},computed:{},created:function(){this.check()},mounted:function(){},destroyed:function(){},methods:{check:function(){var e=this;this.$http.post("system/install",{type:"check"}).then((function(s){s.data.lock?e.$router.replace({path:"/login"}):(e.is_lock=!1,e.system=s.data,s.data.sql||e.$message({message:"数据库sql文件不存在",type:"error"}))}))},tapBefore:function(){this.step>=1&&(this.step=this.step-1)},tapNext:function(){if(0==this.step){var e=this.calcVersion();if(!e)return void this.$message({message:"请检查php版本",type:"error"});this.step=this.step+1}else 1==this.step&&this.tapMysql()},tapMysql:function(){var e=this;this.$refs.infoForm.validate((function(s){if(s){e.loading=!0;var t=Object.assign({type:"mysql"},e.mysql);e.$http.post("system/install",t).then((function(s){e.loading=!1,e.step=e.step+1})).catch((function(){e.loading=!1}))}else e.$message({message:"请检查运行参数",type:"error"})}))},calcVersion:function(){if(!this.system.php)return!1;for(var e=this.system.php.split("."),s="7.4.0".split("."),t=0;t<3;t++){if(e[t]>s[t])return!0;if(e[t]!=s[t])return!1}return!1},tapInstall:function(){var e=this;this.$refs.infoForm.validate((function(s){if(!s)return e.$message({message:"请检查运行参数",type:"error"}),!1;e.loading=!0;var t=Object.assign({type:"install"},e.mysql);e.$http.post("system/install",t).then((function(s){e.$notify({title:"成功",message:s.message,type:"success",duration:2e3}),setTimeout((function(){location.reload()}),1e3),e.loading=!1})).catch((function(){e.loading=!1}))}))}}}),n=l,r=(t("5b18"),t("2877")),o=Object(r["a"])(n,i,a,!1,null,"9d0b2882",null);s["default"]=o.exports}}]);